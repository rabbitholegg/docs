{"version":3,"file":"Budget.cjs","sources":["../../src/Budgets/Budget.ts"],"sourcesContent":["import { aBudgetAbi } from '@boostxyz/evm';\nimport { AManagedBudget } from '@boostxyz/evm/deploys/componentInterfaces.json';\nimport { readContract } from '@wagmi/core';\nimport type { Address, Hex } from 'viem';\nimport type { DeployableOptions } from '../Deployable/Deployable';\nimport { InvalidComponentInterfaceError } from '../errors';\nimport { ManagedBudget } from './ManagedBudget';\n\nexport {\n  // VestingBudget,\n  ManagedBudget,\n};\n\n/**\n * A union type representing all valid protocol Budget implementations\n *\n * @export\n * @typedef {Budget}\n */\nexport type Budget = ManagedBudget; // | VestingBudget\n\n/**\n * A map of Budget component interfaces to their constructors.\n *\n * @type {{ \"0xa0109882\": typeof ManagedBudget; }}\n */\nexport const BudgetByComponentInterface = {\n  // ['0x64683da1']: VestingBudget,\n  // ['0x2929d19c']: SimpleBudget,\n  [AManagedBudget as Hex]: ManagedBudget,\n};\n\n/**\n * A function that will read a contract's component interface using `getComponentInterface` and return the correct instantiated instance.\n *\n * @export\n * @async\n * @param {DeployableOptions} options\n * @param {Address} address\n * @returns {Promise<ManagedBudget>}\n * @throws {@link InvalidComponentInterfaceError}\n */\nexport async function budgetFromAddress(\n  options: DeployableOptions,\n  address: Address,\n) {\n  const interfaceId = (await readContract(options.config, {\n    abi: aBudgetAbi,\n    functionName: 'getComponentInterface',\n    address,\n  })) as keyof typeof BudgetByComponentInterface;\n  const Ctor = BudgetByComponentInterface[interfaceId];\n  if (!Ctor) {\n    throw new InvalidComponentInterfaceError(\n      Object.keys(BudgetByComponentInterface) as Hex[],\n      interfaceId as Hex,\n    );\n  }\n  return new Ctor(options, address);\n}\n"],"names":["BudgetByComponentInterface","AManagedBudget","ManagedBudget","budgetFromAddress","options","address","interfaceId","readContract","aBudgetAbi","Ctor","InvalidComponentInterfaceError"],"mappings":"mQA0BaA,EAA6B,CAGxC,CAACC,EAAqB,cAAA,EAAGC,EAAA,aAC3B,EAYsB,eAAAC,EACpBC,EACAC,EACA,CACA,MAAMC,EAAe,MAAMC,eAAaH,EAAQ,OAAQ,CACtD,IAAKI,EAAA,EACL,aAAc,wBACd,QAAAH,CAAA,CACD,EACKI,EAAOT,EAA2BM,CAAW,EACnD,GAAI,CAACG,EACH,MAAM,IAAIC,EAAA,+BACR,OAAO,KAAKV,CAA0B,EACtCM,CAAA,EAGG,OAAA,IAAIG,EAAKL,EAASC,CAAO,CAClC"}